<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Yahia/Python/src/Freelancer/vulnerability/data/vulnerability.sqlite" readonly="0" foreign_keys="" case_sensitive_like="" temp_store="" wal_autocheckpoint="" synchronous=""/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="2766"/><column_width id="4" width="0"/></tab_structure><tab_browse><current_table name="0,0:"/><default_encoding codec=""/><browse_table_settings/></tab_browse><tab_sql><sql name="Validation">SELECT name, profile_name 
FROM vulnerability v LEFT JOIN assets a on name = a.profile_name
GROUP BY profile_name
HAVING profile_name is NULL

select v.ipaddress, name, profile_name  
FROM vulnerability v LEFT JOIN assets a using (ipaddress)
GROUP BY profile_name
HAVING profile_name is NULL


SELECT ipaddress, assets.profile_name, milestone 
FROM assets left join milestone using (profile_name)
GROUP BY profile_name 
HAVING milestone is NULL


SELECT a.ipaddress, name, profile_name 
FROM assets a LEFT JOIN  vulnerability v  on name = a.profile_name
GROUP BY profile_name
HAVING name is NULL

SELECT name, profile_name 
FROM vulnerability v 
LEFT JOIN stats a on name = a.profile_name
GROUP BY profile_name
HAVING profile_name is NULL

	
</sql><sql name="fix_categ_stats.sql">SELECT a.followup_group, name as 'profile_name', a.vulnerability, a.cveid, vfc.fix_category
FROM(
	SELECT name, vulnerability, cveid, followup_group
        FROM vulnerability vul 
        LEFT JOIN assets ast using (ipaddress)
    WHERE risk in ('High', 'Medium') AND ifnull(ast.exclude,0) = 0
    GROUP by name,vulnerability
	--HAVING name = 'DR-VLAN-73-AIX-Servers-WAS'
	order by 1
)a 
LEFT JOIN vul_fix_category vfc on a.vulnerability = vfc.vulnerability AND a.followup_group = vfc.followup_group
--GROUP BY a.followup_group, vfc.fix_category
ORDER BY 1,2,3


-- SELECT  assets.followup_group, name 'profile_name', v.vulnerability ,vfc.fix_category, count(DISTINCT v.vulnerability) as 'CVEID Count'
-- FROM vulnerability v 
-- 	LEFT JOIN vul_fix_category vfc USING (vulnerability)
-- 	LEFT JOIN assets USING (ipaddress)
-- WHERE v.risk in ('High','Medium') AND ifnull(exclude,0) = 0
-- GROUP BY assets.followup_group, name
-- --HAVING vfc.followup_group is NULL


</sql><sql name="cveid count stats.sql">SELECT a.followup_group, vfc.fix_category, sum(total_vt)
FROM(
	SELECT name, vulnerability, COUNT(DISTINCT vul.vulnerability) as &quot;total_vt&quot;, followup_group
        FROM vulnerability vul 
        LEFT JOIN assets ast using (ipaddress)
    WHERE risk in ('High', 'Medium') AND ifnull(ast.exclude,0) = 0
    GROUP by name,vulnerability
	--HAVING name = 'DR-VLAN-73-AIX-Servers-WAS'
	order by 1
)a 
LEFT JOIN vul_fix_category vfc on a.vulnerability = vfc.vulnerability AND a.followup_group = vfc.followup_group
GROUP BY a.followup_group, vfc.fix_category
ORDER BY 1,2</sql><sql name="SQL 14">	
	SELECT ast.followup_group, name as 'profile name', vul.vulnerability, vul.cveid, vfc.fix_category
        FROM vulnerability vul 
        LEFT JOIN assets ast using (ipaddress)
		LEFT JOIN vul_fix_category vfc USING (vulnerability, followup_group)
    WHERE risk in ('High', 'Medium') AND ifnull(ast.exclude,0) = 0 AND ast.followup_group like '07%'
    GROUP by  vul.vulnerability,vfc.fix_category, followup_group
	order by 1
	

	</sql><current_tab id="3"/></tab_sql></sqlb_project>

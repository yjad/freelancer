from tkinter import Tk, Label, Button, Entry, IntVar, END, W, E, NE, StringVar, DoubleVar, WORD
from tkinter import filedialog
from tkinter.scrolledtext import ScrolledText
from reports import stats_by_ip

class MainMenu():

    def __init__(self, master):
        self.master = master
        self.output_file_name = StringVar()

        master.title ('Vulnerability - Qradar scan files')
        #print(master.configure().keys())

        #Label(master, text='\nOutput',  fg='black', font='none 12 bold').grid(row=0, column=0, sticky = W)

        #self.output_file_name. = 'Output'
        Label(master, textvariable=self.output_file_name,  fg='black', font='none 12 bold').grid(row=0, column=0, sticky = W)

        self.output = ScrolledText(master, width=120, height = 40, wrap = WORD, background = 'white')
        self.output.grid(row=1, column = 0, columnspan = 2, sticky = 'W')

        land_btn = Button(master, text="Load", command = stats_by_ip).grid(row=0, column=2)
        land_btn = Button(master, text="stats by IP", command = self.stats_by_ip).grid(row=0, column=3)
        unit_btn = Button(master, text="Units", command = self.val_unit).grid(row=0, column=4)

        exit_btn = Button(master, text="Exit ", command = master.quit).grid(row=0, column=5, sticky = W)

    def stats_by_ip(self):
        self.output.delete(0.0, END)        # clear window
        file_path = self.select_file_path()
        self.output_file_name.set('Results of file name: '+ file_path)
        stats_by_ip("abc.xlsx")
        # if file_path.split('.')[-1].lower() == 'xlsx':
            # val_land = ValidateLandSheet(file_path)
            # val_land.output_win = self.output
            # val_land.check_land_sheet()
        # elif file_path.split('.')[-1].lower() == 'csv':
            # val_land = ValidateLandCSV(file_path)
            # val_land.output_win = self.output
            # val_land.check_land_sheet()

    def select_file_path(self):
        try:
            file_path = get_file_path(initialDir=".", DialogTitle="select excel/csv sheet", fileTypeText="excel, csv",
                                           fileType="*.xlsx;*.csv")
        except:
            print('No file selected ...')
            return ''
        else:
            return file_path

    def val_unit(self):
        pass

def validate_res_sheet():
    root = Tk()
    #root.attributes('-fullscreen', True)
    root.state('zoomed')
    MainMenu(root)
    root.mainloop()

validate_res_sheet()